:root {
  color-scheme: only light;
  --hud-text: #f3f8ff;
  --hud-border: rgba(188, 213, 238, 0.56);
  --hud-bg: rgba(14, 25, 38, 0.6);
  --accent-bright: #9ff4ff;
  --accent-danger: #ff7d7d;
  --panel-bg: rgba(7, 20, 33, 0.86);
  --panel-border: rgba(138, 178, 212, 0.62);
}

* {
  box-sizing: border-box;
}

.hidden {
  display: none !important;
}

html,
body {
  margin: 0;
  width: 100%;
  height: 100%;
  overflow: hidden;
  font-family: "Bahnschrift", "Trebuchet MS", "Segoe UI", sans-serif;
  background:
    radial-gradient(circle at 16% 18%, rgba(155, 197, 255, 0.18), transparent 44%),
    radial-gradient(circle at 86% 84%, rgba(128, 167, 225, 0.14), transparent 50%),
    #081523;
  color: var(--hud-text);
}

#app,
canvas {
  width: 100%;
  height: 100%;
  display: block;
  touch-action: none;
}

#hud-ui {
  position: fixed;
  top: 14px;
  left: 14px;
  z-index: 36;
  display: grid;
  gap: 6px;
  min-width: 180px;
  padding: 10px 12px;
  border: 1px solid var(--hud-border);
  border-radius: 11px;
  background: var(--hud-bg);
  backdrop-filter: blur(5px);
}

.hud-row {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 10px;
  font: 700 0.69rem/1.2 "Bahnschrift", "Trebuchet MS", "Segoe UI", sans-serif;
  letter-spacing: 0.08em;
}

.hud-key {
  color: rgba(173, 212, 246, 0.9);
}

#player-roster-panel {
  position: fixed;
  top: 118px;
  left: 14px;
  z-index: 37;
  width: min(96vw, 620px);
  max-height: min(74vh, 760px);
  display: grid;
  grid-template-rows: auto auto minmax(0, 1fr);
  gap: 7px;
  padding: 10px;
  border: 1px solid rgba(173, 210, 240, 0.66);
  border-radius: 11px;
  background: rgba(8, 20, 32, 0.9);
  backdrop-filter: blur(6px);
  box-shadow: 0 14px 30px rgba(2, 8, 14, 0.44);
}

.roster-head {
  display: flex;
  align-items: baseline;
  justify-content: space-between;
  gap: 8px;
}

#roster-title {
  color: #e6f5ff;
  font: 800 0.68rem/1.2 "Bahnschrift", "Trebuchet MS", "Segoe UI", sans-serif;
  letter-spacing: 0.1em;
}

#roster-count {
  color: #bfe7ff;
  font: 700 0.58rem/1.2 "Bahnschrift", "Trebuchet MS", "Segoe UI", sans-serif;
  letter-spacing: 0.05em;
}

#roster-subtitle {
  margin: 0;
  color: rgba(181, 214, 239, 0.86);
  font: 700 0.55rem/1.3 "Bahnschrift", "Trebuchet MS", "Segoe UI", sans-serif;
  letter-spacing: 0.03em;
}

#roster-list {
  overflow-y: auto;
  display: grid;
  gap: 6px;
  padding-right: 3px;
  scrollbar-width: thin;
}

.roster-entry {
  display: grid;
  grid-template-columns: auto 1fr auto;
  align-items: center;
  gap: 8px;
  padding: 6px 8px;
  border: 1px solid rgba(155, 199, 233, 0.34);
  border-radius: 8px;
  background: rgba(12, 29, 46, 0.74);
}

.roster-rank {
  min-width: 1.6em;
  color: #9ec8eb;
  font: 700 0.64rem/1 "Bahnschrift", "Trebuchet MS", "Segoe UI", sans-serif;
  letter-spacing: 0.03em;
}

.roster-name {
  color: #eaf6ff;
  font: 700 0.72rem/1.2 "Bahnschrift", "Trebuchet MS", "Segoe UI", sans-serif;
  letter-spacing: 0.03em;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.roster-state {
  color: #c6def2;
  font: 700 0.62rem/1 "Bahnschrift", "Trebuchet MS", "Segoe UI", sans-serif;
  letter-spacing: 0.04em;
}

.roster-entry.eliminated .roster-state {
  color: #ffbcbc;
}

.roster-entry.me {
  border-color: rgba(193, 230, 255, 0.68);
  box-shadow: 0 0 0 1px rgba(146, 190, 224, 0.2);
}

.roster-entry.host .roster-name::before {
  content: "방장 ";
  color: #9ad2ff;
  font-weight: 800;
}

.roster-empty {
  padding: 8px 9px;
  border: 1px solid rgba(155, 199, 233, 0.34);
  border-radius: 8px;
  background: rgba(12, 29, 46, 0.7);
  color: #d8ecff;
  font: 700 0.58rem/1.25 "Bahnschrift", "Trebuchet MS", "Segoe UI", sans-serif;
}

.roster-host-line {
  padding: 4px 6px;
  border: 1px solid rgba(169, 211, 242, 0.4);
  border-radius: 8px;
  background: rgba(11, 30, 47, 0.76);
  color: #c7e7ff;
  font: 700 0.54rem/1.2 "Bahnschrift", "Trebuchet MS", "Segoe UI", sans-serif;
  letter-spacing: 0.03em;
}

.roster-slot-section {
  display: grid;
  gap: 4px;
}

.roster-slot-head {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 6px;
}

.roster-slot-title {
  color: #eaf6ff;
  font: 800 0.55rem/1.2 "Bahnschrift", "Trebuchet MS", "Segoe UI", sans-serif;
  letter-spacing: 0.08em;
}

.roster-slot-count {
  color: #a8d8fa;
  font: 700 0.5rem/1.2 "Bahnschrift", "Trebuchet MS", "Segoe UI", sans-serif;
  letter-spacing: 0.04em;
}

.roster-slot-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(70px, 1fr));
  gap: 4px;
}

.roster-slot {
  min-height: 38px;
  display: grid;
  grid-template-columns: auto 1fr;
  grid-template-rows: auto auto;
  align-items: center;
  gap: 2px 4px;
  padding: 4px 5px;
  border: 1px solid rgba(138, 181, 213, 0.3);
  border-radius: 7px;
  background: rgba(7, 20, 32, 0.56);
}

.roster-slot.filled {
  border-color: rgba(163, 209, 241, 0.5);
  background: rgba(12, 30, 46, 0.82);
}

.roster-slot.queued {
  border-color: rgba(242, 196, 133, 0.58);
}

.roster-slot.me {
  box-shadow: 0 0 0 1px rgba(178, 222, 255, 0.3);
}

.roster-slot-index {
  grid-column: 1;
  grid-row: 1;
  color: #99c8eb;
  font: 700 0.46rem/1 "Bahnschrift", "Trebuchet MS", "Segoe UI", sans-serif;
}

.roster-slot-name {
  grid-column: 2;
  grid-row: 1;
  color: #eaf6ff;
  font: 700 0.5rem/1.15 "Bahnschrift", "Trebuchet MS", "Segoe UI", sans-serif;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.roster-slot-state {
  grid-column: 1 / -1;
  grid-row: 2;
  color: #bad8f0;
  font: 700 0.45rem/1 "Bahnschrift", "Trebuchet MS", "Segoe UI", sans-serif;
  letter-spacing: 0.02em;
}

.roster-slot.queued .roster-slot-state {
  color: #ffd6a8;
}

#mobile-controls {
  position: fixed;
  left: max(14px, env(safe-area-inset-left));
  right: max(14px, env(safe-area-inset-right));
  bottom: max(14px, env(safe-area-inset-bottom));
  z-index: 45;
  display: flex;
  align-items: flex-end;
  justify-content: space-between;
  pointer-events: none;
}

#mobile-controls * {
  -webkit-tap-highlight-color: transparent;
}

#mobile-move-pad,
#mobile-action-pad,
#mobile-look-pad {
  touch-action: none;
  user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}

#mobile-move-pad {
  width: 154px;
  height: 154px;
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  grid-template-rows: repeat(3, 1fr);
  gap: 6px;
  pointer-events: auto;
}

.mobile-move-btn {
  border: 1px solid rgba(167, 204, 233, 0.62);
  border-radius: 11px;
  background: rgba(10, 24, 40, 0.86);
  color: #e6f5ff;
  font: 800 0.9rem/1 "Bahnschrift", "Trebuchet MS", "Segoe UI", sans-serif;
  letter-spacing: 0.02em;
  pointer-events: auto;
}

.mobile-move-btn.up {
  grid-column: 2;
  grid-row: 1;
}

.mobile-move-btn.left {
  grid-column: 1;
  grid-row: 2;
}

.mobile-move-btn.right {
  grid-column: 3;
  grid-row: 2;
}

.mobile-move-btn.down {
  grid-column: 2;
  grid-row: 3;
}

#mobile-action-pad {
  width: 156px;
  display: grid;
  gap: 6px;
  pointer-events: auto;
}

#mobile-action-pad button {
  height: 36px;
  border: 1px solid rgba(169, 208, 238, 0.66);
  border-radius: 10px;
  background: rgba(9, 23, 38, 0.88);
  color: #e9f7ff;
  font: 800 0.68rem/1 "Bahnschrift", "Trebuchet MS", "Segoe UI", sans-serif;
  letter-spacing: 0.07em;
  text-transform: uppercase;
}

#mobile-roster-btn.active,
#mobile-run-btn.active,
.mobile-move-btn.active,
#mobile-action-pad button:active {
  border-color: rgba(203, 233, 255, 0.92);
  box-shadow: 0 0 0 1px rgba(143, 188, 223, 0.36);
  background: rgba(18, 41, 64, 0.94);
}

#mobile-look-pad {
  position: fixed;
  right: max(14px, env(safe-area-inset-right));
  bottom: calc(max(14px, env(safe-area-inset-bottom)) + 160px);
  z-index: 44;
  width: min(44vw, 250px);
  height: min(24vh, 182px);
  min-height: 118px;
  display: grid;
  place-items: center;
  border: 1px dashed rgba(160, 199, 229, 0.34);
  border-radius: 12px;
  background: rgba(9, 20, 31, 0.14);
  color: rgba(181, 215, 241, 0.82);
  font: 700 0.62rem/1.1 "Bahnschrift", "Trebuchet MS", "Segoe UI", sans-serif;
  letter-spacing: 0.07em;
  text-transform: uppercase;
  pointer-events: auto;
}

#mobile-look-pad.active {
  border-color: rgba(193, 225, 250, 0.68);
  background: rgba(17, 40, 62, 0.25);
}

.quiz-controls-head {
  margin-bottom: 2px;
  color: #caf0ff;
  font: 800 0.64rem/1.2 "Bahnschrift", "Trebuchet MS", "Segoe UI", sans-serif;
  letter-spacing: 0.16em;
}

#quiz-controls {
  position: fixed;
  top: 14px;
  right: 14px;
  z-index: 38;
  display: grid;
  gap: 6px;
  min-width: 210px;
  padding: 10px 11px;
  border: 1px solid rgba(172, 213, 246, 0.62);
  border-radius: 11px;
  background: rgba(10, 23, 37, 0.76);
  backdrop-filter: blur(5px);
}

.quiz-controls-row {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 6px;
}

.quiz-host-btn {
  grid-column: 1 / -1;
  background: linear-gradient(140deg, rgba(30, 62, 92, 0.96), rgba(12, 28, 44, 0.98));
}

#quiz-controls button {
  height: 34px;
  border: 1px solid rgba(170, 211, 243, 0.7);
  border-radius: 8px;
  background: rgba(16, 36, 56, 0.94);
  color: #e7f5ff;
  font: 800 0.68rem/1 "Bahnschrift", "Trebuchet MS", "Segoe UI", sans-serif;
  letter-spacing: 0.08em;
  cursor: pointer;
}

#quiz-controls button:hover {
  border-color: rgba(210, 235, 255, 0.92);
}

#quiz-config-btn {
  background: linear-gradient(140deg, rgba(26, 58, 86, 0.96), rgba(12, 31, 48, 0.98));
}

#quiz-review-btn {
  background: linear-gradient(140deg, rgba(34, 70, 42, 0.96), rgba(14, 33, 20, 0.98));
}

.portal-controls-row {
  grid-template-columns: 1fr;
  gap: 5px;
}

#portal-target-input {
  width: 100%;
  height: 33px;
  padding: 0 9px;
  border: 1px solid rgba(171, 208, 238, 0.66);
  border-radius: 8px;
  background: rgba(10, 26, 42, 0.92);
  color: #edf6ff;
  font: 700 0.65rem/1 "Bahnschrift", "Trebuchet MS", "Segoe UI", sans-serif;
  letter-spacing: 0.02em;
  outline: none;
}

#portal-target-input::placeholder {
  color: rgba(188, 215, 238, 0.64);
}

#portal-target-input:focus {
  border-color: rgba(203, 233, 255, 0.95);
  box-shadow: 0 0 0 2px rgba(134, 179, 218, 0.22);
}

#quiz-controls-note {
  color: rgba(196, 225, 248, 0.84);
  font: 700 0.61rem/1.25 "Bahnschrift", "Trebuchet MS", "Segoe UI", sans-serif;
  letter-spacing: 0.04em;
}

#quiz-config-modal,
#quiz-review-modal {
  position: fixed;
  inset: 0;
  z-index: 86;
  display: grid;
  place-items: center;
  padding: 16px;
  background:
    radial-gradient(circle at 18% 14%, rgba(120, 201, 255, 0.2), transparent 44%),
    linear-gradient(180deg, rgba(4, 11, 18, 0.74), rgba(4, 10, 16, 0.9));
}

#quiz-config-panel,
#quiz-review-panel {
  width: min(96vw, 760px);
  max-height: min(88vh, 860px);
  overflow: auto;
  display: grid;
  gap: 8px;
  padding: 14px;
  border: 1px solid rgba(163, 208, 240, 0.7);
  border-radius: 12px;
  background: linear-gradient(150deg, rgba(13, 32, 49, 0.94), rgba(8, 20, 31, 0.97));
  box-shadow: 0 18px 40px rgba(2, 8, 14, 0.5);
}

#quiz-review-panel {
  width: min(92vw, 560px);
}

.quiz-modal-head {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 10px;
}

.quiz-modal-head h2 {
  margin: 0;
  color: #ebf8ff;
  font: 800 0.95rem/1.2 "Bahnschrift", "Trebuchet MS", "Segoe UI", sans-serif;
  letter-spacing: 0.08em;
}

.quiz-modal-head button {
  height: 30px;
  padding: 0 10px;
  border: 1px solid rgba(178, 216, 245, 0.68);
  border-radius: 8px;
  background: rgba(13, 31, 47, 0.9);
  color: #e5f7ff;
  font: 700 0.64rem/1 "Bahnschrift", "Trebuchet MS", "Segoe UI", sans-serif;
  letter-spacing: 0.06em;
  text-transform: uppercase;
  cursor: pointer;
}

.quiz-config-toolbar {
  display: grid;
  grid-template-columns: auto 76px auto auto auto;
  align-items: center;
  gap: 7px;
}

.quiz-config-toolbar label {
  color: #cde8fb;
  font: 700 0.62rem/1.2 "Bahnschrift", "Trebuchet MS", "Segoe UI", sans-serif;
  letter-spacing: 0.06em;
}

#quiz-slot-count-input {
  height: 30px;
  border: 1px solid rgba(163, 207, 238, 0.68);
  border-radius: 7px;
  background: rgba(10, 27, 42, 0.9);
  color: #ecf8ff;
  font: 700 0.66rem/1 "Bahnschrift", "Trebuchet MS", "Segoe UI", sans-serif;
  letter-spacing: 0.03em;
  text-align: center;
}

.quiz-checkbox {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  color: #d4ecff;
  font: 700 0.62rem/1 "Bahnschrift", "Trebuchet MS", "Segoe UI", sans-serif;
}

.quiz-config-toolbar button,
.quiz-config-actions button {
  height: 30px;
  padding: 0 10px;
  border: 1px solid rgba(178, 216, 245, 0.68);
  border-radius: 8px;
  background: rgba(13, 31, 47, 0.9);
  color: #e5f7ff;
  font: 700 0.62rem/1 "Bahnschrift", "Trebuchet MS", "Segoe UI", sans-serif;
  letter-spacing: 0.06em;
  text-transform: uppercase;
  cursor: pointer;
}

#quiz-config-status {
  margin: 0;
  color: #c5e2f8;
  font: 700 0.64rem/1.3 "Bahnschrift", "Trebuchet MS", "Segoe UI", sans-serif;
}

#quiz-config-status.error {
  color: #ffd1d1;
}

#quiz-question-list {
  display: grid;
  gap: 6px;
}

.quiz-question-row {
  display: grid;
  grid-template-columns: 34px 1fr 82px;
  gap: 6px;
  padding: 7px;
  border: 1px solid rgba(146, 193, 226, 0.48);
  border-radius: 8px;
  background: rgba(9, 25, 40, 0.72);
}

.quiz-question-order {
  display: grid;
  place-items: center;
  color: #b4d9f5;
  font: 700 0.6rem/1 "Bahnschrift", "Trebuchet MS", "Segoe UI", sans-serif;
}

.quiz-question-fields {
  display: grid;
  gap: 5px;
}

.quiz-question-fields input,
.quiz-question-fields textarea,
.quiz-question-answer {
  width: 100%;
  border: 1px solid rgba(158, 201, 233, 0.62);
  border-radius: 7px;
  background: rgba(10, 28, 43, 0.9);
  color: #e8f7ff;
  font: 700 0.62rem/1.3 "Bahnschrift", "Trebuchet MS", "Segoe UI", sans-serif;
  letter-spacing: 0.02em;
}

.quiz-question-fields input {
  height: 30px;
  padding: 0 8px;
}

.quiz-question-fields textarea {
  min-height: 56px;
  padding: 6px 8px;
  resize: vertical;
}

.quiz-question-answer {
  height: 30px;
  padding: 0 7px;
}

.quiz-config-actions {
  display: flex;
  justify-content: flex-end;
  gap: 6px;
}

#quiz-review-index,
#quiz-review-question,
#quiz-review-answer,
#quiz-review-explanation {
  margin: 0;
}

#quiz-review-index {
  color: #b9def9;
  font: 700 0.62rem/1.2 "Bahnschrift", "Trebuchet MS", "Segoe UI", sans-serif;
}

#quiz-review-question {
  color: #f0f9ff;
  font: 800 0.82rem/1.35 "Bahnschrift", "Trebuchet MS", "Segoe UI", sans-serif;
}

#quiz-review-answer {
  color: #d3ecff;
  font: 700 0.68rem/1.25 "Bahnschrift", "Trebuchet MS", "Segoe UI", sans-serif;
}

#quiz-review-explanation {
  color: #c6e0f5;
  font: 700 0.66rem/1.4 "Bahnschrift", "Trebuchet MS", "Segoe UI", sans-serif;
  white-space: pre-wrap;
}

#hub-flow-ui {
  position: fixed;
  top: 14px;
  left: 50%;
  z-index: 34;
  transform: translateX(-50%);
  width: min(92vw, 560px);
  pointer-events: none;
}

#hub-billboard {
  display: grid;
  gap: 6px;
  padding: 14px 18px;
  border: 1px solid var(--panel-border);
  border-radius: 12px;
  background:
    linear-gradient(140deg, rgba(30, 58, 89, 0.72), rgba(8, 19, 30, 0.9)),
    radial-gradient(circle at 18% 10%, rgba(153, 220, 255, 0.2), transparent 42%);
  box-shadow:
    0 0 0 1px rgba(117, 162, 196, 0.18),
    0 10px 26px rgba(3, 10, 16, 0.44);
  backdrop-filter: blur(6px);
}

.hub-kicker {
  margin: 0;
  color: #9ed7ff;
  font: 700 0.67rem/1.2 "Bahnschrift", "Trebuchet MS", "Segoe UI", sans-serif;
  letter-spacing: 0.2em;
}

#hub-phase-title {
  margin: 0;
  font: 700 1.22rem/1.2 "Bahnschrift", "Trebuchet MS", "Segoe UI", sans-serif;
  color: #ecf8ff;
  letter-spacing: 0.02em;
  text-transform: uppercase;
}

#hub-phase-subtitle {
  margin: 0;
  color: #c3ddf4;
  font: 600 0.82rem/1.3 "Bahnschrift", "Trebuchet MS", "Segoe UI", sans-serif;
  letter-spacing: 0.04em;
}

#lobby-screen {
  position: fixed;
  inset: 0;
  z-index: 82;
  display: grid;
  place-items: center;
  padding: 18px;
  background:
    radial-gradient(circle at 18% 14%, rgba(122, 203, 255, 0.22), transparent 42%),
    radial-gradient(circle at 84% 86%, rgba(109, 166, 224, 0.18), transparent 48%),
    linear-gradient(180deg, rgba(3, 9, 15, 0.78), rgba(3, 8, 13, 0.92));
}

#lobby-form {
  width: min(96vw, 640px);
  display: grid;
  gap: 10px;
  padding: 20px;
  border: 1px solid rgba(160, 203, 236, 0.7);
  border-radius: 15px;
  background:
    linear-gradient(150deg, rgba(12, 33, 51, 0.94), rgba(7, 19, 31, 0.96)),
    radial-gradient(circle at 14% 10%, rgba(136, 198, 245, 0.24), transparent 44%);
  box-shadow:
    0 18px 44px rgba(2, 8, 14, 0.58),
    0 0 0 1px rgba(118, 167, 205, 0.2);
}

.lobby-kicker {
  margin: 0;
  color: #9fd6ff;
  font: 700 0.7rem/1.2 "Bahnschrift", "Trebuchet MS", "Segoe UI", sans-serif;
  letter-spacing: 0.2em;
}

#lobby-title {
  margin: 0;
  color: #eef9ff;
  font: 800 1.24rem/1.2 "Bahnschrift", "Trebuchet MS", "Segoe UI", sans-serif;
  letter-spacing: 0.07em;
}

#lobby-status {
  margin: 0;
  color: #c8e4f9;
  font: 700 0.78rem/1.35 "Bahnschrift", "Trebuchet MS", "Segoe UI", sans-serif;
  letter-spacing: 0.03em;
}

#lobby-status.error {
  color: #ffd2d2;
}

#lobby-stats {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 8px;
}

.lobby-stat {
  display: grid;
  gap: 5px;
  padding: 9px 10px;
  border: 1px solid rgba(141, 189, 224, 0.56);
  border-radius: 10px;
  background: rgba(10, 27, 43, 0.72);
}

.lobby-stat-key {
  color: #9fc5e6;
  font: 700 0.66rem/1.2 "Bahnschrift", "Trebuchet MS", "Segoe UI", sans-serif;
  letter-spacing: 0.1em;
}

.lobby-stat span:last-child {
  color: #ecf8ff;
  font: 800 1rem/1.15 "Bahnschrift", "Trebuchet MS", "Segoe UI", sans-serif;
}

#lobby-top-room {
  margin: 0;
  color: #bedbf2;
  font: 700 0.66rem/1.3 "Bahnschrift", "Trebuchet MS", "Segoe UI", sans-serif;
  letter-spacing: 0.03em;
}

#lobby-slot-summary {
  display: grid;
  gap: 3px;
  padding: 7px 8px;
  border: 1px solid rgba(138, 188, 223, 0.48);
  border-radius: 8px;
  background: rgba(9, 25, 39, 0.7);
}

#lobby-slot-summary p {
  margin: 0;
  color: #cae7fb;
  font: 700 0.6rem/1.25 "Bahnschrift", "Trebuchet MS", "Segoe UI", sans-serif;
  letter-spacing: 0.03em;
}

#lobby-form label {
  color: #bce5ff;
  font: 700 0.68rem/1.2 "Bahnschrift", "Trebuchet MS", "Segoe UI", sans-serif;
  letter-spacing: 0.14em;
  text-transform: uppercase;
}

#lobby-name-input {
  width: 100%;
  height: 43px;
  padding: 0 12px;
  border: 1px solid rgba(167, 213, 247, 0.72);
  border-radius: 9px;
  background: rgba(11, 28, 44, 0.94);
  color: #edf7ff;
  font: 700 0.9rem/1 "Bahnschrift", "Trebuchet MS", "Segoe UI", sans-serif;
  letter-spacing: 0.06em;
  outline: none;
}

#lobby-name-input::placeholder {
  color: rgba(182, 215, 242, 0.62);
}

#lobby-name-input:focus {
  border-color: rgba(191, 228, 255, 0.98);
  box-shadow: 0 0 0 2px rgba(145, 195, 232, 0.25);
}

#lobby-join-btn {
  height: 42px;
  border: 1px solid rgba(179, 220, 250, 0.82);
  border-radius: 9px;
  background: linear-gradient(140deg, rgba(20, 53, 83, 0.95), rgba(9, 22, 35, 0.98));
  color: #e8f7ff;
  font: 700 0.8rem/1 "Bahnschrift", "Trebuchet MS", "Segoe UI", sans-serif;
  letter-spacing: 0.08em;
  text-transform: uppercase;
  cursor: pointer;
}

#lobby-join-btn:hover {
  border-color: rgba(198, 231, 255, 0.95);
}

#nickname-gate {
  position: fixed;
  inset: 0;
  z-index: 80;
  display: grid;
  place-items: center;
  padding: 18px;
  background:
    radial-gradient(circle at 22% 20%, rgba(99, 188, 248, 0.2), transparent 48%),
    linear-gradient(180deg, rgba(4, 10, 17, 0.76), rgba(4, 10, 17, 0.9));
}

#nickname-form {
  width: min(92vw, 460px);
  display: grid;
  gap: 10px;
  padding: 18px;
  border: 1px solid rgba(145, 191, 228, 0.68);
  border-radius: 14px;
  background: var(--panel-bg);
  box-shadow: 0 16px 38px rgba(2, 8, 14, 0.5);
}

#nickname-title {
  margin: 0;
  color: #ebf8ff;
  font: 700 1.06rem/1.2 "Bahnschrift", "Trebuchet MS", "Segoe UI", sans-serif;
  letter-spacing: 0.06em;
  text-transform: uppercase;
}

.nickname-copy {
  margin: 0;
  color: #b6d7f2;
  font: 600 0.84rem/1.35 "Bahnschrift", "Trebuchet MS", "Segoe UI", sans-serif;
  letter-spacing: 0.03em;
}

#nickname-form label {
  color: #bce5ff;
  font: 700 0.68rem/1.2 "Bahnschrift", "Trebuchet MS", "Segoe UI", sans-serif;
  letter-spacing: 0.14em;
  text-transform: uppercase;
}

#nickname-input {
  width: 100%;
  height: 42px;
  padding: 0 12px;
  border: 1px solid rgba(167, 213, 247, 0.7);
  border-radius: 9px;
  background: rgba(11, 28, 44, 0.94);
  color: #edf7ff;
  font: 700 0.91rem/1 "Bahnschrift", "Trebuchet MS", "Segoe UI", sans-serif;
  letter-spacing: 0.06em;
  text-transform: uppercase;
  outline: none;
}

#nickname-input::placeholder {
  color: rgba(182, 215, 242, 0.62);
}

#nickname-input:focus {
  border-color: rgba(191, 228, 255, 0.98);
  box-shadow: 0 0 0 2px rgba(145, 195, 232, 0.25);
}

#nickname-error {
  margin: 0;
  color: #ffbcbc;
  font: 700 0.75rem/1.3 "Bahnschrift", "Trebuchet MS", "Segoe UI", sans-serif;
  letter-spacing: 0.03em;
}

#nickname-submit {
  height: 42px;
  border: 1px solid rgba(179, 220, 250, 0.82);
  border-radius: 9px;
  background: linear-gradient(140deg, rgba(20, 53, 83, 0.95), rgba(9, 22, 35, 0.98));
  color: #e8f7ff;
  font: 700 0.8rem/1 "Bahnschrift", "Trebuchet MS", "Segoe UI", sans-serif;
  letter-spacing: 0.08em;
  text-transform: uppercase;
  cursor: pointer;
}

#nickname-submit:hover {
  border-color: rgba(198, 231, 255, 0.95);
}

#portal-transition {
  position: fixed;
  inset: 0;
  z-index: 90;
  display: grid;
  place-items: center;
  gap: 10px;
  background: rgba(2, 7, 13, 0.96);
  opacity: 0;
  pointer-events: none;
  transition: opacity 460ms ease;
}

#portal-transition.on {
  opacity: 1;
  pointer-events: auto;
}

.portal-loader {
  width: 52px;
  height: 52px;
  border-radius: 50%;
  border: 4px solid rgba(189, 226, 255, 0.26);
  border-top-color: rgba(232, 247, 255, 0.96);
  animation: portal-spin 880ms linear infinite;
}

@keyframes portal-spin {
  to {
    transform: rotate(360deg);
  }
}

#portal-transition-text {
  margin: 0;
  color: #e8f7ff;
  font: 700 0.86rem/1.2 "Bahnschrift", "Trebuchet MS", "Segoe UI", sans-serif;
  letter-spacing: 0.08em;
  text-transform: uppercase;
}

#boundary-warning {
  position: fixed;
  left: 50%;
  bottom: 18vh;
  z-index: 88;
  min-width: min(92vw, 360px);
  max-width: min(92vw, 520px);
  padding: 11px 14px;
  border: 1px solid rgba(255, 169, 169, 0.7);
  border-radius: 10px;
  background: rgba(44, 10, 14, 0.84);
  color: #ffe5e5;
  font: 700 0.79rem/1.4 "Bahnschrift", "Trebuchet MS", "Segoe UI", sans-serif;
  letter-spacing: 0.04em;
  text-align: center;
  opacity: 0;
  transform: translate(-50%, 8px);
  transition: opacity 180ms ease, transform 180ms ease;
  pointer-events: none;
  box-shadow: 0 10px 24px rgba(8, 2, 3, 0.35);
}

#boundary-warning.on {
  opacity: 1;
  transform: translate(-50%, 0);
}

#round-overlay {
  position: fixed;
  inset: 0;
  z-index: 92;
  opacity: 0;
  pointer-events: none;
  background: rgba(1, 4, 8, 0.74);
  transition: opacity 320ms ease;
}

#round-overlay.on {
  opacity: 1;
}

#round-overlay[data-mode="prepare"] {
  background: rgba(3, 8, 14, 0.5);
}

#round-overlay-canvas {
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
  display: block;
}

#round-overlay-panel {
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  display: grid;
  gap: 8px;
  width: min(92vw, 640px);
  padding: 20px 24px;
  border: 1px solid rgba(186, 220, 244, 0.62);
  border-radius: 14px;
  background: rgba(6, 16, 26, 0.7);
  backdrop-filter: blur(6px);
  text-align: center;
  box-shadow: 0 18px 40px rgba(1, 5, 8, 0.48);
}

#round-overlay-title {
  margin: 0;
  color: #f2fbff;
  font: 800 1.38rem/1.2 "Bahnschrift", "Trebuchet MS", "Segoe UI", sans-serif;
  letter-spacing: 0.08em;
}

#round-overlay-subtitle {
  margin: 0;
  color: #cfe8fb;
  font: 700 0.88rem/1.35 "Bahnschrift", "Trebuchet MS", "Segoe UI", sans-serif;
  letter-spacing: 0.04em;
}

#entry-wait-overlay {
  position: fixed;
  inset: 0;
  z-index: 89;
  display: grid;
  place-items: center;
  padding: 16px;
  background: rgba(4, 10, 16, 0.62);
  pointer-events: none;
}

#entry-wait-panel {
  width: min(92vw, 520px);
  display: grid;
  gap: 8px;
  padding: 18px 20px;
  border: 1px solid rgba(171, 207, 236, 0.68);
  border-radius: 12px;
  background: rgba(8, 21, 34, 0.86);
  box-shadow: 0 14px 34px rgba(2, 7, 11, 0.42);
  text-align: center;
}

#entry-wait-panel h2 {
  margin: 0;
  color: #ecf8ff;
  font: 800 1.1rem/1.2 "Bahnschrift", "Trebuchet MS", "Segoe UI", sans-serif;
  letter-spacing: 0.06em;
}

#entry-wait-text {
  margin: 0;
  color: #c8e3f8;
  font: 700 0.82rem/1.35 "Bahnschrift", "Trebuchet MS", "Segoe UI", sans-serif;
  letter-spacing: 0.03em;
}

#tool-ui {
  position: fixed;
  left: 50%;
  bottom: 16px;
  z-index: 35;
  transform: translateX(-50%);
  display: grid;
  gap: 8px;
  min-width: 320px;
  justify-items: center;
  pointer-events: auto;
}

#tool-hotbar {
  display: flex;
  gap: 8px;
  align-items: stretch;
}

.tool-slot {
  min-width: 110px;
  height: 44px;
  display: flex;
  gap: 8px;
  align-items: center;
  justify-content: center;
  border: 1px solid rgba(170, 201, 233, 0.56);
  border-radius: 10px;
  background: rgba(10, 23, 37, 0.8);
  color: #d8edff;
  font: 700 0.73rem/1 "Bahnschrift", "Trebuchet MS", "Segoe UI", sans-serif;
  letter-spacing: 0.06em;
  cursor: pointer;
  backdrop-filter: blur(5px);
}

.tool-slot img {
  width: 16px;
  height: 16px;
  opacity: 0.9;
  filter: invert(87%) sepia(20%) saturate(466%) hue-rotate(178deg) brightness(102%) contrast(98%);
}

.tool-slot.active {
  border-color: rgba(201, 226, 250, 0.92);
  box-shadow: 0 0 0 2px rgba(141, 181, 220, 0.24);
  background: rgba(16, 38, 58, 0.9);
}

.tool-key {
  min-width: 20px;
  height: 20px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  border: 1px solid rgba(174, 205, 234, 0.48);
  border-radius: 5px;
  font-size: 0.64rem;
  color: #9ec8ed;
}

#chalk-colors {
  display: flex;
  gap: 8px;
  padding: 7px 9px;
  border: 1px solid rgba(168, 197, 225, 0.52);
  border-radius: 999px;
  background: rgba(9, 20, 31, 0.84);
  backdrop-filter: blur(5px);
}

.chalk-color {
  width: 24px;
  height: 24px;
  border-radius: 50%;
  border: 1px solid rgba(198, 219, 241, 0.68);
  background: var(--swatch, #f5f7ff);
  cursor: pointer;
}

.chalk-color.active {
  box-shadow:
    0 0 0 2px rgba(225, 240, 255, 0.92),
    0 0 0 5px rgba(124, 172, 216, 0.35);
}

#chat-ui {
  position: fixed;
  left: 14px;
  bottom: 14px;
  z-index: 25;
  display: grid;
  gap: 8px;
  align-items: stretch;
  padding: 8px;
  width: min(66vw, 380px);
  border: 1px solid rgba(179, 208, 236, 0.62);
  border-radius: 10px;
  background: rgba(10, 21, 34, 0.82);
  backdrop-filter: blur(5px);
}

#chat-log {
  height: 132px;
  overflow-y: auto;
  padding: 8px;
  border: 1px solid rgba(174, 206, 237, 0.5);
  border-radius: 8px;
  background: rgba(11, 25, 41, 0.9);
  font: 600 0.74rem/1.35 "Bahnschrift", "Trebuchet MS", "Segoe UI", sans-serif;
  letter-spacing: 0.03em;
  scrollbar-width: thin;
}

#chat-controls {
  display: flex;
  gap: 6px;
  align-items: center;
}

.chat-line {
  margin: 0 0 6px;
  color: #ddeeff;
  word-break: break-word;
}

.chat-line:last-child {
  margin-bottom: 0;
}

.chat-line.self {
  color: #ffffff;
}

.chat-line.system {
  color: #c0daef;
  font-style: italic;
}

.chat-name {
  color: #a7cdf1;
  margin-right: 6px;
}

#chat-input {
  flex: 1;
  width: 100%;
  height: 36px;
  padding: 0 11px;
  border: 1px solid rgba(177, 210, 240, 0.64);
  border-radius: 8px;
  background: rgba(12, 28, 44, 0.92);
  color: #edf6ff;
  font: 600 0.85rem/1 "Bahnschrift", "Trebuchet MS", "Segoe UI", sans-serif;
  outline: none;
}

#chat-input::placeholder {
  color: rgba(193, 221, 245, 0.76);
}

#chat-input:focus {
  border-color: rgba(196, 225, 250, 0.98);
  box-shadow: 0 0 0 2px rgba(149, 187, 228, 0.26);
}

#boot-error {
  position: fixed;
  inset: 0;
  z-index: 99;
  display: grid;
  place-items: center;
  padding: 20px;
  text-align: center;
  background: rgba(6, 10, 16, 0.9);
  color: #ffd9d9;
  font-size: 0.95rem;
}

@media (max-width: 640px) {
  #hud-ui {
    top: max(6px, env(safe-area-inset-top));
    left: max(8px, env(safe-area-inset-left));
    right: max(8px, env(safe-area-inset-right));
    width: auto;
    min-width: 0;
    grid-template-columns: repeat(4, minmax(0, 1fr));
    padding: 6px 7px;
    gap: 4px;
  }

  .hud-row {
    flex-direction: column;
    align-items: flex-start;
    justify-content: flex-start;
    gap: 2px;
    font-size: 0.52rem;
    letter-spacing: 0.04em;
  }

  .hud-key {
    font-size: 0.44rem;
    letter-spacing: 0.06em;
  }

  #hud-position {
    max-width: 100%;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
  }

  #player-roster-panel {
    top: auto;
    left: 8px;
    right: 8px;
    bottom: 194px;
    width: auto;
    max-height: 44vh;
    padding: 8px 9px;
  }

  .roster-slot-grid {
    grid-template-columns: repeat(auto-fill, minmax(58px, 1fr));
    gap: 3px;
  }

  .roster-slot {
    min-height: 34px;
    padding: 3px 4px;
  }

  .roster-slot-name {
    font-size: 0.45rem;
  }

  .roster-slot-state,
  .roster-slot-index {
    font-size: 0.41rem;
  }

  #hub-flow-ui {
    top: 8px;
    width: calc(100vw - 14px);
  }

  #quiz-controls {
    top: auto;
    bottom: 14px;
    right: 10px;
    min-width: 175px;
    padding: 8px;
    gap: 5px;
  }

  #quiz-controls button {
    height: 32px;
    font-size: 0.63rem;
  }

  #portal-target-input {
    height: 31px;
    font-size: 0.62rem;
  }

  #hub-billboard {
    padding: 11px 12px;
    gap: 4px;
  }

  #lobby-form {
    width: min(96vw, 640px);
    padding: 14px;
    gap: 8px;
  }

  #lobby-title {
    font-size: 1.04rem;
  }

  #lobby-status {
    font-size: 0.76rem;
  }

  #lobby-stats {
    grid-template-columns: 1fr;
    gap: 6px;
  }

  .lobby-stat span:last-child {
    font-size: 0.9rem;
  }

  #hub-phase-title {
    font-size: 0.95rem;
  }

  #hub-phase-subtitle {
    font-size: 0.73rem;
  }

  #nickname-form {
    padding: 14px;
  }

  #tool-ui {
    min-width: 0;
    width: calc(100vw - 20px);
    bottom: 124px;
    gap: 6px;
  }

  #tool-hotbar {
    width: 100%;
  }

  .tool-slot {
    flex: 1;
    min-width: 0;
  }

  #chalk-colors {
    gap: 6px;
    padding: 6px 8px;
  }

  #chat-ui {
    left: 10px;
    right: 10px;
    bottom: 224px;
    width: auto;
  }

  #chat-log {
    height: 110px;
  }

  #chat-input {
    font-size: 0.8rem;
  }

  #round-overlay-panel {
    padding: 14px 12px;
  }

  #round-overlay-title {
    font-size: 1.02rem;
  }

  #round-overlay-subtitle {
    font-size: 0.76rem;
  }

  #entry-wait-panel {
    padding: 14px 12px;
    gap: 6px;
  }

  #entry-wait-panel h2 {
    font-size: 0.98rem;
  }

  #entry-wait-text {
    font-size: 0.74rem;
  }

  #quiz-config-panel,
  #quiz-review-panel {
    width: min(98vw, 760px);
    max-height: min(90vh, 860px);
    padding: 10px;
  }

  .quiz-config-toolbar {
    grid-template-columns: 1fr 62px 1fr 1fr;
    gap: 6px;
  }

  .quiz-config-toolbar label[for="quiz-slot-count-input"] {
    grid-column: 1;
  }

  #quiz-slot-count-input {
    grid-column: 2;
  }

  .quiz-checkbox {
    justify-self: end;
  }

  .quiz-config-toolbar .quiz-checkbox:nth-of-type(1) {
    grid-column: 3;
  }

  .quiz-config-toolbar .quiz-checkbox:nth-of-type(2) {
    grid-column: 4;
  }

  #quiz-config-reset-btn {
    grid-column: 1 / -1;
    width: 100%;
  }

  .quiz-question-row {
    grid-template-columns: 28px 1fr 66px;
    gap: 5px;
    padding: 6px;
  }

  #mobile-controls {
    left: max(8px, env(safe-area-inset-left));
    right: max(8px, env(safe-area-inset-right));
    bottom: max(8px, env(safe-area-inset-bottom));
  }

  #mobile-move-pad {
    width: 144px;
    height: 144px;
  }

  #mobile-action-pad {
    width: 136px;
    gap: 5px;
  }

  #mobile-action-pad button {
    height: 40px;
    font-size: 0.61rem;
  }

  #mobile-look-pad {
    right: max(8px, env(safe-area-inset-right));
    bottom: calc(max(8px, env(safe-area-inset-bottom)) + 168px);
    width: min(46vw, 240px);
    height: min(22vh, 176px);
    min-height: 112px;
  }
}

@media (max-width: 640px) and (max-height: 760px) {
  #player-roster-panel {
    bottom: 184px;
    max-height: 40vh;
  }

  #chat-ui {
    bottom: 206px;
  }

  #mobile-look-pad {
    bottom: calc(max(8px, env(safe-area-inset-bottom)) + 146px);
    min-height: 100px;
  }
}
